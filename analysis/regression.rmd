---
title: "regression"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
devtools::load_all("../chigcrim/")
```

## Imports
```{r message=FALSE}
library(tidyverse)
library(lubridate)
library(randomForest)
devtools::load_all("../chigcrim/")

set.seed(1)
```

## Data
```{r}
# Downoad training data
crime_train <- load_data(c(2016, 2018), strings_as_factors = TRUE)
# Download test data
crime_test <- load_data(2019, strings_as_factors = TRUE)
```


```{r}
GAM <- PoissonGAM$new(time_period = "week", region = "community_area",
                     include_nb = FALSE, include_crimetype = FALSE, 
                     filter_week = TRUE)
# Fit using gam_train as the dataset 
GAM$fit(crime_train, convert = T, n_threads = 7)
GAM$gam_fitted
GAM$fit_summary
# Prediction on the same dataset
GAM$predict()
train_preds <- GAM$predictions

GAM$predict(df_test = crime_test, convert = T) 
GAM$predictions

count_dat <- GAM$count_train
```
```
